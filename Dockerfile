# Filename: Dockerfile

# use latest alpine image
FROM lsiobase/alpine:3.14

WORKDIR ${APP_LOCATION}

ENV APP_LOCATION=/app

# version label
ARG BUILD_DATE
ARG VERSION

LABEL build_version="hippie68-exploit-docker Version:- ${VERSION} Build-date:- ${BUILD_DATE}"
LABEL maintainer="stevenstrike"

# install web app
RUN apk add --no-cache \
	wget~=1.21.1-r1 \
	python3~=3.9.5-r1 && \
	
	wget -O /$APP_LOCATION/main.zip https://github.com/hippie68/hippie68.github.io/archive/refs/heads/main.zip && \
	# unzip without creating directory and replace all files
	unzip -jo /$APP_LOCATION/main.zip && \
	
	# cleanup
	rm -rf /tmp/* \
			/var/tmp/* && \
	rm -rf /$APP_LOCATION/main.zip

# HealthCheck
HEALTHCHECK --interval=30s --timeout=3s \
  CMD curl -f http://localhost/:7001 || exit 1
  
# export port 7001
EXPOSE 7001/tcp

# start webserver
CMD ["sh", "-c", "python3 -m http.server 7001"]